/*!
 * 
 * RT-Theme 19 WordPress Theme Admin - Location Finder
 * Copyright (C) 2014 RT-Themes
 * http://rtthemes.com
 *
 */
!function(a){a(document.body).on("click",".open-rt-location-finder",function(c){c.preventDefault();var d=a(".rt-location-selector");if(0==d.length&&(a(rt_location_finder.map_html).appendTo("body"),d=a(".rt-location-selector"),(new b).init(d.find(".gllpLatlonPicker"))),d.show("fade",{duration:300,easing:"swing"}),a("html, body").css({overflow:"hidden"}).scrollTop(0),""!==a(this).val()){{var e=a(this).val().split(",");a(".gllpLatitude").val(e[0]),a(".gllpLongitude").val(e[1]),a(".gllpZoom").val(16)}a(".gllpUpdateButton").trigger("click")}d.find(".select_map").on("click",function(){var b=a(".rt_geo_selection .lat"),c=a(".rt_geo_selection .lon"),e=a(".gllpLatitude").val(),f=a(".gllpLongitude").val();b.val(e),c.val(f),d.find(".rt_modal_close").trigger("click")})});var b=function(){var b=this;b.params={defLat:0,defLng:0,defZoom:1,queryLocationNameWhenLatLngChanges:!0,queryElevationWhenLatLngChanges:!0,mapOptions:{mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,disableDoubleClickZoom:!0,zoomControlOptions:!0,streetViewControl:!1},strings:{markerText:"Drag this Marker",error_empty_field:"Couldn't find coordinates for this place",error_no_results:"Couldn't find coordinates for this place"}},b.vars={ID:null,LATLNG:null,map:null,marker:null,geocoder:null};var c=function(c){b.vars.marker.setPosition(c),b.vars.map.panTo(c),a(b.vars.cssID+".gllpZoom").val(b.vars.map.getZoom()),a(b.vars.cssID+".gllpLongitude").val(c.lng()),a(b.vars.cssID+".gllpLatitude").val(c.lat()),a(b.vars.cssID).trigger("location_changed",a(b.vars.cssID)),b.params.queryLocationNameWhenLatLngChanges&&d(c),b.params.queryElevationWhenLatLngChanges&&e(c)},d=function(c){var d=new google.maps.LatLng(c.lat(),c.lng());b.vars.geocoder.geocode({latLng:d},function(c,d){a(b.vars.cssID+".gllpLocationName").val(d==google.maps.GeocoderStatus.OK&&c[1]?c[1].formatted_address:""),a(b.vars.cssID).trigger("location_name_changed",a(b.vars.cssID))})},e=function(c){var d=new google.maps.LatLng(c.lat(),c.lng()),e=[d],f={locations:e};b.vars.elevator.getElevationForLocations(f,function(c,d){a(b.vars.cssID+".gllpElevation").val(d==google.maps.ElevationStatus.OK?c[0]?c[0].elevation.toFixed(3):"":""),a(b.vars.cssID).trigger("elevation_changed",a(b.vars.cssID))})},f=function(d,e){return""==d?void(e||g(b.params.strings.error_empty_field)):void b.vars.geocoder.geocode({address:d},function(d,f){f==google.maps.GeocoderStatus.OK?(a(b.vars.cssID+".gllpZoom").val(11),b.vars.map.setZoom(parseInt(a(b.vars.cssID+".gllpZoom").val())),c(d[0].geometry.location)):e||g(b.params.strings.error_no_results)})},g=function(a){alert(a)},h={init:function(d){a(d).attr("id")||(a(d).attr("name")?a(d).attr("id",a(d).attr("name")):a(d).attr("id","_MAP_"+Math.ceil(1e4*Math.random()))),b.vars.ID=a(d).attr("id"),b.vars.cssID="#"+b.vars.ID+" ",b.params.defLat=a(b.vars.cssID+".gllpLatitude").val()?a(b.vars.cssID+".gllpLatitude").val():b.params.defLat,b.params.defLng=a(b.vars.cssID+".gllpLongitude").val()?a(b.vars.cssID+".gllpLongitude").val():b.params.defLng,b.params.defZoom=a(b.vars.cssID+".gllpZoom").val()?parseInt(a(b.vars.cssID+".gllpZoom").val()):b.params.defZoom,b.vars.LATLNG=new google.maps.LatLng(b.params.defLat,b.params.defLng),b.vars.MAPOPTIONS=b.params.mapOptions,b.vars.MAPOPTIONS.zoom=b.params.defZoom,b.vars.MAPOPTIONS.center=b.vars.LATLNG,b.vars.map=new google.maps.Map(a(b.vars.cssID+".gllpMap").get(0),b.vars.MAPOPTIONS),b.vars.geocoder=new google.maps.Geocoder,b.vars.elevator=new google.maps.ElevationService,b.vars.marker=new google.maps.Marker({position:b.vars.LATLNG,map:b.vars.map,title:b.params.strings.markerText,draggable:!0}),google.maps.event.addListener(b.vars.map,"dblclick",function(a){c(a.latLng)}),google.maps.event.addListener(b.vars.marker,"dragend",function(){c(b.vars.marker.position)}),google.maps.event.addListener(b.vars.map,"zoom_changed",function(){a(b.vars.cssID+".gllpZoom").val(b.vars.map.getZoom()),a(b.vars.cssID).trigger("location_changed",a(b.vars.cssID))}),a(b.vars.cssID+".gllpUpdateButton").bind("click",function(){var d=a(b.vars.cssID+".gllpLatitude").val(),e=a(b.vars.cssID+".gllpLongitude").val(),f=new google.maps.LatLng(d,e);b.vars.map.setZoom(parseInt(a(b.vars.cssID+".gllpZoom").val())),c(f)}),a(b.vars.cssID+".gllpSearchButton").bind("click",function(){f(a(b.vars.cssID+".gllpSearchField").val(),!1)}),a(document).bind("gllp_perform_search",function(b,c){f(a(c).attr("string"),!0)}),a(document).bind("gllp_update_fields",function(){var d=a(b.vars.cssID+".gllpLatitude").val(),e=a(b.vars.cssID+".gllpLongitude").val(),f=new google.maps.LatLng(d,e);b.vars.map.setZoom(parseInt(a(b.vars.cssID+".gllpZoom").val())),c(f)})}};return h}}(jQuery);